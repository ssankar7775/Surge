<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="description" content="SURGE - Advanced Space Mission Budget Calculator. Analyze power systems, link budgets, and mission performance with real-time visualization.">
    <meta name="keywords" content="space mission, power budget, link budget, satellite, aerospace, engineering">
    <meta name="author" content="SURGE Team">
    <title>Space Mission Budget Calculator</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3E◆%3C/text%3E%3C/svg%3E">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="chart.umd.js"></script>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo-section">
                <h1>◆ SURGE</h1>
                <p class="subtitle">Space Mission Budget Calculator</p>
            </div>
            <nav class="main-nav">
                <button id="power-budget-btn" class="nav-btn active">Power Budget</button>
                <button id="link-budget-btn" class="nav-btn">Link Budget</button>
                <button id="system-performance-btn" class="nav-btn">System Performance</button>
            </nav>
        </div>
    </header>
    <main>
        <section id="power-budget-section" class="budget-section">
            <h2>Power Budget</h2>
            <section id="drafts-section">
                <h3>Drafts & Models</h3>
                <div class="form-group">
                    <label for="model-name">Model Name:</label>
                    <input type="text" id="model-name" placeholder="Enter model name">
                </div>
                <div class="form-group">
                    <label for="model-desc">Description (optional):</label>
                    <textarea id="model-desc" placeholder="Enter description"></textarea>
                </div>
                <button id="save-new-model">Save as New Model</button>
                <button id="update-model">Update Current Model</button>
                <div class="form-group">
                    <label for="load-model">Load Model:</label>
                    <select id="load-model">
                        <option value="">Select a model</option>
                    </select>
                    <button id="load-selected-model">Load</button>
                </div>
                <div id="current-model-info"></div>
                <div class="button-group">
                    <button id="export-data" class="btn-secondary">Export Data</button>
                    <button id="import-data" class="btn-secondary">Import Data</button>
                    <input type="file" id="import-file" accept=".json" style="display: none;">
                </div>
                <button id="clear-all-data" style="background-color: #f44336; color: white; margin-top: 1rem;">Clear All Data</button>
                <p style="color: #666; font-size: 0.9em; margin-top: 0.5rem;">Warning: This will delete all saved models, components, and modes permanently.</p>
            </section>
            <div class="tabs">
                <button class="tab-button active" data-tab="model">Current Model</button>
                <button class="tab-button" data-tab="library">Component Library</button>
                <button class="tab-button" data-tab="modes">Modes</button>
            </div>
            <div class="tab-content hidden" id="library-tab">
                <h3>Component Library</h3>
                <form id="library-form">
                    <div class="form-group">
                        <label for="lib-name">Component Name/Description:</label>
                        <input type="text" id="lib-name" required>
                    </div>
                    <div class="form-group">
                        <label for="lib-model">Component Model Number:</label>
                        <input type="text" id="lib-model">
                    </div>
                    <div class="form-group">
                        <label for="lib-voltage">Voltage (V):</label>
                        <input type="number" id="lib-voltage" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="lib-current">Current (A):</label>
                        <input type="number" id="lib-current" step="0.01" required>
                    </div>
                    <button type="submit">Add to Library</button>
                </form>
                <h4>Library Components</h4>
                <ul id="library-list"></ul>
                <h4>Add to Current Model</h4>
                <p>Select components from the library to add to your current model:</p>
                <div id="library-add-to-model"></div>
                <h4>Copy from Current Model</h4>
                <p>Copy components from your current model to the library (this doesn't remove them from your model):</p>
                <div id="model-to-library"></div>
            </div>
            <div class="tab-content" id="model-tab">
                <h3>Current Model Components</h3>
                <form id="model-form">
                    <div class="form-group">
                        <label for="component-name">Component Name/Description:</label>
                        <input type="text" id="component-name" required>
                    </div>
                    <div class="form-group">
                        <label for="model-model">Component Model Number:</label>
                        <input type="text" id="model-model">
                    </div>
                    <div class="form-group">
                        <label for="model-voltage">Voltage (V):</label>
                        <input type="number" id="model-voltage" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="model-current">Current (A):</label>
                        <input type="number" id="model-current" step="0.01" required>
                    </div>
                    <button type="submit">Add to Current Model</button>
                </form>
                <ul id="model-list"></ul>
                <section id="battery-section">
                    <h3>Battery Analysis</h3>
                    <div class="form-group">
                        <label for="dod">Depth of Discharge (%):</label>
                        <input type="number" id="dod" step="1" value="80">
                    </div>
                    <div class="form-group">
                        <label for="efficiency">Efficiency (%):</label>
                        <input type="number" id="efficiency" step="1" value="90">
                    </div>
                    <div class="form-group">
                        <label for="bus-voltage">Bus Voltage (V):</label>
                        <input type="number" id="bus-voltage" step="0.01" value="28">
                    </div>
                    <button id="calculate-battery">Calculate Battery Capacity</button>
                    <div id="battery-results"></div>
                </section>
                <table id="power-budget-table">
                    <thead id="table-head">
                        <tr>
                            <th>Component</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
                <div id="mode-totals"></div>
                <div id="total-power">Total Power (All Modes): 0 W</div>
            </div>
            <div class="tab-content hidden" id="modes-tab">
                <h3>Define Modes</h3>
                <div class="form-group">
                    <label for="mode-name-input">Mode Name:</label>
                    <input type="text" id="mode-name-input">
                    <label for="mode-duration">Duration (hours):</label>
                    <input type="number" id="mode-duration" step="0.01">
                    <label for="copy-from">Copy from:</label>
                    <select id="copy-from">
                        <option value="">None</option>
                    </select>
                    <button id="add-mode-global">Add Mode</button>
                </div>
                <ul id="modes-list"></ul>
            </div>

            <!-- Power System Performance Charts -->
            <section id="power-charts-section" class="charts-container">
                <h2>Power System Performance Analysis</h2>
                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <h3>Power Consumption by Mode</h3>
                        <canvas id="powerByModeChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h3>Energy Distribution</h3>
                        <canvas id="energyDistributionChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h3>Power vs Time</h3>
                        <canvas id="powerTimeChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h3>Battery Capacity Analysis</h3>
                        <canvas id="batteryAnalysisChart"></canvas>
                    </div>
                </div>
            </section>
        </section>

        <section id="link-budget-section" class="budget-section hidden">
            <h2>Link Budget Calculator</h2>
            <div class="link-budget-container">
                <div class="link-budget-form-section">
                    <h3>Link Parameters</h3>
                    <form id="link-budget-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="frequency">Frequency (GHz):</label>
                                <input type="number" id="frequency" step="0.01" value="2.4" required>
                            </div>
                            <div class="form-group">
                                <label for="transmit-power">Transmit Power (dBW):</label>
                                <input type="number" id="transmit-power" step="0.01" value="10" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="transmit-gain">Transmit Antenna Gain (dBi):</label>
                                <input type="number" id="transmit-gain" step="0.01" value="15" required>
                            </div>
                            <div class="form-group">
                                <label for="transmit-losses">Transmit Losses (dB):</label>
                                <input type="number" id="transmit-losses" step="0.01" value="1" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="distance">Distance (km):</label>
                                <input type="number" id="distance" step="0.01" value="1000" required>
                            </div>
                            <div class="form-group">
                                <label for="receive-gain">Receive Antenna Gain (dBi):</label>
                                <input type="number" id="receive-gain" step="0.01" value="20" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="receive-losses">Receive Losses (dB):</label>
                                <input type="number" id="receive-losses" step="0.01" value="1" required>
                            </div>
                            <div class="form-group">
                                <label for="atmospheric-loss">Atmospheric Loss (dB):</label>
                                <input type="number" id="atmospheric-loss" step="0.01" value="0.5" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="noise-temp">System Noise Temperature (K):</label>
                                <input type="number" id="noise-temp" step="0.01" value="290" required>
                            </div>
                            <div class="form-group">
                                <label for="bandwidth">Bandwidth (Hz):</label>
                                <input type="number" id="bandwidth" step="0.01" value="1000000" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="required-snr">Required SNR (dB):</label>
                                <input type="number" id="required-snr" step="0.01" value="10" required>
                            </div>
                            <div class="form-group">
                                <label for="modulation-loss">Modulation Loss (dB):</label>
                                <input type="number" id="modulation-loss" step="0.01" value="2" required>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn-primary">Calculate Link Budget</button>
                            <button type="button" id="reset-link-budget" class="btn-secondary">Reset</button>
                        </div>
                    </form>
                </div>

                <div class="link-budget-results-section">
                    <h3>Link Budget Results</h3>
                    <div id="link-budget-results" class="results-panel hidden">
                        <div class="results-grid">
                            <div class="result-item">
                                <span class="result-label">EIRP:</span>
                                <span id="eirp" class="result-value"></span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Free Space Path Loss:</span>
                                <span id="path-loss" class="result-value"></span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Received Power:</span>
                                <span id="received-power" class="result-value"></span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Noise Power:</span>
                                <span id="noise-power" class="result-value"></span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">SNR:</span>
                                <span id="snr" class="result-value"></span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Link Margin:</span>
                                <span id="link-margin" class="result-value"></span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Link Status:</span>
                                <span id="link-status" class="result-value"></span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Data Rate:</span>
                                <span id="data-rate" class="result-value"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Link Budget Performance Charts -->
            <section id="link-charts-section" class="charts-container">
                <h3>Link Performance Analysis</h3>
                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <h4>Link Margin vs Distance</h4>
                        <canvas id="linkMarginVsDistanceChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4>SNR vs Frequency</h4>
                        <canvas id="snrVsFrequencyChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Received Power vs Transmit Power</h4>
                        <canvas id="powerVsTxPowerChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Link Budget Breakdown</h4>
                        <canvas id="linkBudgetBreakdownChart"></canvas>
                    </div>
                </div>
            </section>
        </section>
        <section id="system-performance-section" class="budget-section hidden">
            <h2>System Performance Analysis</h2>
            <p class="section-description">Comprehensive analysis combining power system and communications link performance for complete mission assessment.</p>

            <!-- Power System Performance Charts -->
            <section id="system-power-charts-section" class="charts-container">
                <h3>Power System Performance</h3>
                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <h4>Power Consumption by Mode</h4>
                        <canvas id="systemPowerByModeChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Energy Distribution</h4>
                        <canvas id="systemEnergyDistributionChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Power vs Time</h4>
                        <canvas id="systemPowerTimeChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Battery Capacity Analysis</h4>
                        <canvas id="systemBatteryAnalysisChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Link Budget Performance Charts -->
            <section id="system-link-charts-section" class="charts-container">
                <h3>Communications Link Performance</h3>
                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <h4>Link Margin vs Distance</h4>
                        <canvas id="systemLinkMarginVsDistanceChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4>SNR vs Frequency</h4>
                        <canvas id="systemSnrVsFrequencyChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Received Power vs Transmit Power</h4>
                        <canvas id="systemPowerVsTxPowerChart"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h4>Link Budget Breakdown</h4>
                        <canvas id="systemLinkBudgetBreakdownChart"></canvas>
                    </div>
                </div>
            </section>
        </section>
    </main>

    <script src="script.js"></script>
</body>
</html>